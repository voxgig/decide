!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Decide=n()}}((function(){var n={exports:{}};(function(e){!function(t){"object"==typeof n.exports?n.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Patrun=t()}((function(){var n={exports:{}};function t(e){e=e||{};var t={},r={};function i(n,e,t){if(t){var r=n.g=n.g||{},i=r[e]=r[e]||[];i.push(t),i.sort((function(n,e){return n.val$<e.val$}))}}return t.top=function(){return r},t.add=function(o,f){o={...o};var u="function"==typeof e?e.call(t,o,f):null,s=Object.keys(o),l=[],c=[];s.forEach((function(n){var t=o[n];null!=t&&(t=String(t),o[n]=t,(e.gex&&t.match(/[*?]/)?c:l).push(n))})),l=l.sort(),c=c.sort(),s=l.concat(c);for(var a,d=r,p=0;p<s.length;p++){var v=s[p],h=o[v],g=e.gex&&h.match(/[*?]/)?n(h):null;g&&(g.val$=h);var y=(g?"1":"0")+"~"+v;if((a=d.v)&&y==d.sk)i(d,v,g),d=a[h]||(a[h]={});else if(d.k)if(y<d.sk){var k=d.s,w=d.g;d.s={k:d.k,sk:d.sk,v:d.v},k&&(d.s.s=k),w&&(d.s.g=w),d.g&&(d.g={}),i(d,v,g),d.k=v,d.sk=y,d.v={},d=d.v[h]={}}else a=d.v,d=d.s||(d.s={}),p--;else i(d,v,g),d.k=v,d.sk=y,d.v={},d=d.v[h]={}}return void 0!==f&&d&&(d.d=f,u&&(d.f="function"==typeof u?u:u.find,d.r="function"==typeof u.remove?u.remove:void 0)),t},t.findexact=function(n){return t.find(n,!0)},t.find=function(n,i,o){if(null==n)return null;var f=r,u=void 0===r.d?null:r.d,s=r.f,l=null,c=[],a={},d=Object.keys(n).length,p=[];void 0!==r.d&&p.push(r.d);do{if(l=f.k,f.v){var v=n[l],h=f.v[v];if(!h&&e.gex&&f.g&&f.g[l])for(var g=f.g[l],y=0;y<g.length;y++)if(null!=g[y].on(v)){h=f.v[g[y].val$];break}h?(a[l]=!0,f.s&&c.push(f.s),u=void 0===h.d?i?null:u:h.d,o&&void 0!==h.d&&p.push(h.d),s=h.f,f=h):f=f.s}else f=null;null==f&&0<c.length&&(null==u||o&&!i)&&(f=c.pop())}while(f);return i?Object.keys(a).length!==d&&(u=null):null==u&&void 0!==r.d&&(u=r.d),s&&(u=s.call(t,n,u)),o?p:u},t.remove=function(n){var e,t=r,i=null,o=[];do{if(e=t.k,t.v){var f=t.v[n[e]];f?(o.push({km:t,v:n[e]}),i=f.d,t=f):t=t.s}else t=null}while(t);if(void 0!==i){var u=o[o.length-1];if(u&&u.km&&u.km.v){var s=u.km.v[u.v];s.r&&!s.r(n,s.d)||delete s.d}}},t.list=function(e,t){e=e||{};var i=[];return r.d&&i.push({match:{},data:r.d,find:r.f}),function r(i,o,f,u){if(i.v){var s,l=i.k,c=n(e?null==e[l]?t?null:"*":e[l]:"*"),a={...o},d={...f};for(var p in i.v)if(p===e[l]||!t&&null==e[l]||c.on(p)){var v={...a};v[l]=p;var h={...d};delete h[l],s=i.v[p],0===Object.keys(h).length&&s&&s.d&&u.push({match:v,data:s.d,find:s.f}),s&&null!=s.v&&r(s,{...v},{...h},u)}(s=i.s)&&r(s,{...a},{...d},u)}}(r,{},{...e},i),i},t.toString=function(n,e){var t=!0===n||!!e,i="function"==typeof n?n:function(n){return"function"==typeof n?"<"+n.name+">":"<"+n+">"};function o(n,e){for(var t=0;t<e;t++)n.push(" ")}var f=[],u=[];return function n(e,t,r,u){var s;if(void 0!==e.d&&(t.push(" "+i(e.d)),f.push(u.join(", ")+" -> "+i(e.d))),e.k&&(t.push("\n"),o(t,r),t.push(e.k+":")),e.v){r++;var l=Object.keys(e.v),c=l.filter((function(n){return!n.match(/[*?]/)})),a=l.filter((function(n){return n.match(/[*?]/)}));c.sort(),a.sort(),l=c.concat(a);for(var d=0;d<l.length;d++){var p=l[d];t.push("\n"),o(t,r),t.push(p+" ->"),(s=u.slice()).push(e.k+"="+p),n(e.v[p],t,r+1,s)}e.s&&(t.push("\n"),o(t,r),t.push("|"),s=u.slice(),n(e.s,t,r+1,s))}}(r,u,0,[]),t?u.join(""):f.join("\n")},t.inspect=t.toString,t.toJSON=function(n){return JSON.stringify(r,(function(n,e){return"function"==typeof e?"[Function]":e}),n)},t}return function(e){!function(t){"object"==typeof n.exports?n.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Gex=t()}((function(){var n;function e(n){return new t(n)}function t(n){var e=this;function t(n){return null==n||Number.isNaN(n)}function r(n){var e=""+n;return t(n)&&(e=""),e}function i(n){n=""+n;for(var e=!1,t=Object.keys(u),r=0;r<t.length&&!e;r++)e=!!u[t[r]].exec(n);return e}e.on=function(n){if(null==n)return null;var e=typeof n;if("string"===e||"number"===e||"boolean"===e||n instanceof Date||n instanceof RegExp)return i(n)?n:null;if(Array.isArray(n)){for(var r=[],o=0;o<n.length;o++)!t(n[o])&&i(n[o])&&r.push(n[o]);return r}var f={};for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&i(u)&&(f[u]=n[u]);return f},e.esc=function(n){var e=r(n);return(e=e.replace(/\*/g,"**")).replace(/\?/g,"*?")},e.re=function(n){if(""===n||n)return n="^"+(n=(n=(n=(n=(n=e.escregexp(n)).replace(/\\\*/g,"[\\s\\S]*")).replace(/\\\?/g,"[\\s\\S]")).replace(/\[\\s\\S\]\*\[\\s\\S\]\*/g,"\\*")).replace(/\[\\s\\S\]\*\[\\s\\S\]/g,"\\?"))+"$",new RegExp(n);var t=Object.keys(u);return 1==t.length?u[t[0]]:{...u}},e.escregexp=function(n){return n?(""+n).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):""},e.toString=function(){return null!=o?o:o="gex["+Object.keys(u)+"]"},e.inspect=function(){return e.toString()};var o,f=Array.isArray(n)?n:[n],u={};f.forEach((function(n){n=r(n);var t=e.re(n);u[n]=t}))}return n=e,e.Gex=t,n}))}.call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n=n.exports,function(n){return new t(n)}}))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n=n.exports;return class{constructor(n){this._patrun={}}decide(n,e){return this._patrun[n].find(e)}table(e){let t=e;"string"==typeof e?t=this.parse(e):Array.isArray(e);let r=this._patrun[t.n]=new n({gex:!0});t.t.forEach(n=>{r.add(n.c,n.r)})}parse(n){let e={t:[],f:{}},t=null,r=n.split(/[\n\r]/).map(n=>(t=n.match(/^([^#]+)/),t&&t[1]||"")).filter(n=>""!=n&&!n.match(/^\s+$/)&&!n.match(/^\s*#/)&&!n.match(/^=+$/)),i=0,o=r[0];for(e.n=o.match(/^\w+/)[0],o=r[++i];t=o.match(/^(\w+)\s*=\s*(.*)$/);){let n=t[1],f={v:t[2].split(/\s*(,|\s+)\s*/).filter(n=>""!=n&&","!=n&&!n.match(/^\s+$/))};e.f[n]=f,o=r[++i]}for(t=o.split(/\s*=>\s*/),e.c=t[0].split(/\s+/),e.r=t[1].split(/\s+/),o=r[++i];o&&(t=o.split(/\s*=>\s*/));){let n={},f=t[0].split(/\s+/),u=t[1].split(/\s+/);n.c=e.c.reduce((n,e,t)=>(n[e]=f[t],n),{}),n.r=e.r.reduce((n,e,t)=>(n[e]=u[t],n),{}),e.t.push(n),o=r[++i]}return e}}}));